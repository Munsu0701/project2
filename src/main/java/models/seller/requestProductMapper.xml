<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="RequestProductMap">
	<resultMap type="models.seller.ProductDto" id="productmap">
		<result column="abnum" property="abnum"/>
		<result column="seller" property="seller" />
		<result column="serialnum" property="serialnum"/>
		<result column="name" property="name"/>
		<result column="price" property="price"/>
		<result column="kategorie" property="kategorie"/>
		<result column="company" property="company"/>
		<result column="img" property="img"/>
		<result column="status" property="status"/>
		<result column="regDt" property="regDt"/>
		<result column="modDt" property="modDt"/>
	</resultMap>

<insert id="register"  parameterType="models.seller.ProductDto" useGeneratedKeys="true"
        keyProperty="abnum" keyColumn="abnum">
	INSERT RequestProduct ( serialnum, name, price, kategorie, company, img) 
		VALUES (#{serialnum},#{name},#{price},#{kategorie},#{company},#{img})
</insert>

<!-- 미승인 상품 목록 불러오기 -->
<select id="getReq" parameterType="models.seller.ProductDto" resultMap="productmap">
	SELECT * FROM RequestProduct WHERE status=#{status} ORDER BY abnum DESC;
</select>

<!-- 관리자 미승인 상품 목록 검색 -->
<select id="searchReq" parameterType="models.seller.ProductDto" resultMap="productmap">
	SELECT * FROM RequestProduct
	<where>
		<if test="seller != null">AND seller LIKE #{seller}</if>
		<if test="name != null">AND name LIKE #{name}</if>
		<if test="kategorie != null">AND kategorie LIKE #{kategorie}</if>
		<if test="company != null">AND company LIKE #{company}</if>
	</where>
	ORDER BY abnum DESC;
</select>

<!-- 상품 status 상태 업데이트 -->
<update id="statusUp" parameterType="models.seller.ProductDto" >
	UPDATE RequestProduct
			SET
				status=#{status},
				modDt=NOW()
			WHERE abnum=#{abnum};
</update>

</mapper>